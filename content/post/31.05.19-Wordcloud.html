---
title: Wordclouds
author: ''
date: '2019-06-04'
categories:
  - R
  - wordcloud
tags:
  - R
  - Wordcloud
  - R Markdown
slug: 
lastmod: '2019-06-04T15:01:07+01:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
---



<div id="tldr" class="section level3">
<h3>TLDR</h3>
<p>Wordclouds can be used to produce a neat summary of a text, even if they do sacrifice substance (information) for style. They can readily be produced in R.</p>
<hr />
</div>
<div id="summarising-the-content-of-an-upcoming-conference-paper" class="section level3">
<h3>Summarising the content of an upcoming conference paper</h3>
<p>There is an <a href="https://cran.r-project.org/web/packages/wordcloud/index.html">R package dedicated to creating wordclouds</a>, so I’ve started by loading this, along with the tidyverse.</p>
<pre class="r"><code>library(wordcloud); library(tidyverse)</code></pre>
<p>The wordcloud package creates a graphic of words that appear in some specified text. The more times the word appears in the text, the larger it appears in the wordcloud. R can read text from a local file, as shown below, or from a website.</p>
<pre class="r"><code># We can read a text file using &#39;readLines&#39; and we can select a file interactively using &#39;file.choose&#39;
# Both of these are Base R functions
paper &lt;- readLines(file.choose())</code></pre>
<p>Because of the way I’ve read my text, the ‘paper’ variable is currently as list of individual lines, as we can see when viewing one of its elements:</p>
<pre class="r"><code>print(paper[2])
## [1] &quot;Application of MCMC Sampling to Account for Variability and Dependency&quot;</code></pre>
<p>As a result, I need to extract the individual words, which I’ve saved to a new variable:</p>
<pre class="r"><code>paperRows &lt;- strsplit(paste(unlist(paper), collapse = &quot; &quot;), &#39;\n&#39;)
paperWords &lt;- unlist(strsplit(paste(unlist(paperRows), collapse = &quot; &quot;), &#39; &#39;))</code></pre>
<p>The next step is to create a dataframe that will eventually have two columns of interest to us: a list of words, and a count of the number of times they feature in the paper. I’ve set up an empty dataframe of the required size, and also added a check to identify small words (since I think words like ‘the’ are likely to feature a lot in the text, and I’d like the option of removing them from my wordcloud).</p>
<pre class="r"><code>paperWordData &lt;- data.frame(word = c(rep(x = 0, times = length(paperWords))), 
                       count = c(rep(x = 0, times = length(paperWords))),
                       check = c(rep(x = 0, times = length(paperWords))))

paperWordData$word &lt;- as.vector(paperWords)

maxLength &lt;- 5

for (i in seq(from = 1, to = nrow(paperWordData), by = 1)){
  paperWordData$count[i] &lt;- sum(paperWords == paperWords[i])
  if (nchar(paperWordData$word[i]) &lt; maxLength) {
    paperWordData$check[i] &lt;- 0
  } else {
    paperWordData$check[i] &lt;- 1
  }
}</code></pre>
<p>I’ll then convert all words to lower case. Without this, if a word had begun with a capital letter (perhaps because it was starting a sentence) it would not have been included in the same count as instances of the same word beginning with a lower case letter.</p>
<pre class="r"><code>paperWordData$word &lt;- tolower(paperWordData$word)</code></pre>
<p>Time to make use of the filter that was previously set up to remove, short and uninteresting words.</p>
<pre class="r"><code>paperWordData &lt;- unique(paperWordData) %&gt;% 
  dplyr::filter(check == 1)</code></pre>
<p>After reviewing the resultant wordcloud, I realised that my filter removing all words of length &lt; 5 was not as comprehensive as I first thought. There were sti
ll a few words I didn’t want to see, and I’ve resorted to doing this manually. Not very elegant, sadly.</p>
<pre class="r"><code>skippedWords &lt;- c(&#39;which&#39;, &#39;there&#39;, &#39;these&#39;, &#39;therefore&#39;)

paperWordData &lt;- paperWordData %&gt;% 
  dplyr::filter(!grepl(paste(skippedWords, collapse=&#39;|&#39;), word))</code></pre>
<p>Finally, time to ask the wordcloud function to read and plot our data. There are some useful arguments to experiment with here:</p>
<ul>
<li><strong>min.freq</strong> and <strong>max.words</strong> set boundaries for how populated the wordcloud will be</li>
<li><strong>random.order</strong> will put the largest word in the middle if set to FALSE</li>
<li><strong>rot.per</strong> is the fraction of words that will be rotated in the graphic</li>
</ul>
<p>Finally, the words are arranged stochastically somehow, and so for a repeatable graphic it is best to specify a seed value.</p>
<pre class="r"><code>set.seed(1008)
wordcloud(words = paperWordData$word, 
                     freq = paperWordData$count, 
                     min.freq = 3, max.words = 100, 
                     random.order = FALSE, rot.per = 0.25, 
                     colors = brewer.pal(n = 8, name = &#39;Dark2&#39;))</code></pre>
<p><img src="/post/31.05.19-Wordcloud_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>If you’re not familiar with the colour palettes, the below line will ask R to display them for you:</p>
<pre class="r"><code>RColorBrewer::display.brewer.all()</code></pre>
</div>
